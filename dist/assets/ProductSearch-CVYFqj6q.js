import{j as e}from"./ui-vendor-S1POobSh.js";import{k as O,r as t}from"./react-vendor-DrHQLvTy.js";import{y as A,z as G,B as c,g as o,q as K}from"./index-B_z83aGI.js";import{S as Q,a as T,b as V}from"./sheet-N8TNJy76.js";import{P,a as X}from"./ProductSort-BHI-R7fF.js";import{P as $}from"./ProductCard-DGlgknfq.js";import{F as D}from"./filter-CDTGhXC7.js";import{G as J,L as U}from"./list-CSrzmTAL.js";import{L as M}from"./loader-circle-C6mRpfx8.js";import"./chart-vendor-Bfyd95vO.js";import"./supabase-vendor-C-7U-qZP.js";import"./form-vendor-CeA2iSy3.js";import"./checkbox-B751KjRM.js";import"./slider-Cq0KOhSO.js";import"./collapsible-CsGVlbxX.js";import"./chevron-up-DCfO1O8C.js";import"./chevron-down-B_2yl-Ju.js";import"./select-gZt-o9w_.js";import"./dollar-sign-DXLWm596.js";import"./WishlistButton-DcIgUw2y.js";import"./map-pin-Cx6R8BJE.js";const fe=()=>{const[h,R]=O(),[d,b]=t.useState(h.get("q")||""),[g,y]=t.useState("grid"),[x,B]=t.useState("relevance"),[a,i]=t.useState({priceRange:[0,1e7],categories:[],brands:[],rating:0,freeShipping:!1,inStock:!1,location:[]}),[l,p]=t.useState({products:[],totalCount:0,hasMore:!1,page:1}),[L,E]=t.useState(!1),[k,C]=t.useState(!1),[u,w]=t.useState(null),[q,f]=t.useState(1),[j,F]=t.useState(!1);t.useEffect(()=>{const s=h.get("q")||"";b(s)},[h]),t.useEffect(()=>{N(1,!0)},[d,a,x]);const N=async(s=1,r=!1)=>{r?(C(!0),w(null),f(1)):F(!0);try{const n={query:d,categories:a.categories,brands:a.brands,priceRange:a.priceRange,rating:a.rating,freeShipping:a.freeShipping,inStock:a.inStock,location:a.location},v=await A.searchProducts(n,x,s,20);p(r?v:I=>({...v,products:[...I.products,...v.products]})),f(s)}catch(n){console.error("Search failed:",n),n.name!=="AbortError"&&w("C√≥ l·ªói x·∫£y ra khi t√¨m ki·∫øm. Vui l√≤ng th·ª≠ l·∫°i."),r&&p({products:[],totalCount:0,hasMore:!1,page:1})}finally{C(!1),F(!1)}},z=()=>{l.hasMore&&!j&&N(q+1,!1)},H=s=>{b(s),R(s?{q:s}:{}),f(1)},S=()=>{i({priceRange:[0,1e7],categories:[],brands:[],rating:0,freeShipping:!1,inStock:!1,location:[]})},m=()=>{let s=0;return a.categories.length>0&&(s+=a.categories.length),a.brands.length>0&&(s+=a.brands.length),a.rating>0&&s++,a.freeShipping&&s++,a.inStock&&s++,a.location.length>0&&(s+=a.location.length),(a.priceRange[0]>0||a.priceRange[1]<1e7)&&s++,s};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b sticky top-0 z-40",children:e.jsx("div",{className:"container mx-auto px-4 py-4",children:e.jsx(G,{onSearch:H,className:"mx-auto",autoNavigate:!1})})}),e.jsx("div",{className:"container mx-auto px-4 py-6",children:e.jsxs("div",{className:"flex gap-6",children:[e.jsx("div",{className:"hidden lg:block w-80 flex-shrink-0",children:e.jsx("div",{className:"sticky top-24",children:e.jsx(P,{filters:a,onFiltersChange:i,onClearFilters:S})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 mb-6 shadow-sm",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(Q,{open:L,onOpenChange:E,children:[e.jsx(T,{asChild:!0,children:e.jsxs(c,{variant:"outline",className:"lg:hidden",children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"B·ªô l·ªçc",m()>0&&e.jsx(o,{variant:"secondary",className:"ml-2",children:m()})]})}),e.jsx(V,{side:"left",className:"w-80 p-0",children:e.jsx("div",{className:"p-4",children:e.jsx(P,{filters:a,onFiltersChange:i,onClearFilters:S})})})]}),e.jsxs("div",{className:"hidden sm:flex border rounded-lg",children:[e.jsx(c,{variant:g==="grid"?"default":"ghost",size:"sm",onClick:()=>y("grid"),className:"rounded-r-none",children:e.jsx(J,{className:"h-4 w-4"})}),e.jsx(c,{variant:g==="list"?"default":"ghost",size:"sm",onClick:()=>y("list"),className:"rounded-l-none",children:e.jsx(U,{className:"h-4 w-4"})})]})]}),e.jsx(X,{sortBy:x,onSortChange:B,totalResults:l.totalCount})]}),m()>0&&e.jsxs(e.Fragment,{children:[e.jsx(K,{className:"my-4"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"B·ªô l·ªçc ƒëang √°p d·ª•ng:"}),a.categories.map(s=>e.jsxs(o,{variant:"secondary",className:"cursor-pointer",onClick:()=>i(r=>({...r,categories:r.categories.filter(n=>n!==s)})),children:[s," √ó"]},s)),a.brands.map(s=>e.jsxs(o,{variant:"secondary",className:"cursor-pointer",onClick:()=>i(r=>({...r,brands:r.brands.filter(n=>n!==s)})),children:[s," √ó"]},s)),a.rating>0&&e.jsxs(o,{variant:"secondary",className:"cursor-pointer",onClick:()=>i(s=>({...s,rating:0})),children:[a.rating,"+ sao √ó"]}),a.freeShipping&&e.jsx(o,{variant:"secondary",className:"cursor-pointer",onClick:()=>i(s=>({...s,freeShipping:!1})),children:"Mi·ªÖn ph√≠ ship √ó"}),a.inStock&&e.jsx(o,{variant:"secondary",className:"cursor-pointer",onClick:()=>i(s=>({...s,inStock:!1})),children:"C√≤n h√†ng √ó"})]})]})]}),k&&e.jsxs("div",{className:"bg-white rounded-lg p-12 text-center",children:[e.jsx(M,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-orange-500"}),e.jsx("p",{className:"text-gray-600",children:"ƒêang t√¨m ki·∫øm s·∫£n ph·∫©m..."})]}),u&&e.jsxs("div",{className:"bg-white rounded-lg p-12 text-center",children:[e.jsx("div",{className:"text-red-400 text-6xl mb-4",children:"‚ö†Ô∏è"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"C√≥ l·ªói x·∫£y ra"}),e.jsx("p",{className:"text-gray-600 mb-4",children:u}),e.jsx(c,{onClick:()=>N(1,!0),variant:"outline",children:"Th·ª≠ l·∫°i"})]}),!k&&!u&&e.jsx(e.Fragment,{children:l.products.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`grid gap-4 ${g==="grid"?"grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5":"grid-cols-1"}`,children:l.products.map(s=>e.jsx($,{product:s},s.id))}),l.hasMore&&e.jsx("div",{className:"text-center mt-8",children:e.jsx(c,{onClick:z,disabled:j,variant:"outline",size:"lg",children:j?e.jsxs(e.Fragment,{children:[e.jsx(M,{className:"h-4 w-4 animate-spin mr-2"}),"ƒêang t·∫£i..."]}):"Xem th√™m s·∫£n ph·∫©m"})}),e.jsxs("div",{className:"text-center mt-6 text-sm text-gray-500",children:["Hi·ªÉn th·ªã ",l.products.length," / ",l.totalCount," s·∫£n ph·∫©m"]})]}):e.jsxs("div",{className:"bg-white rounded-lg p-12 text-center",children:[e.jsx("div",{className:"text-gray-400 text-6xl mb-4",children:"üîç"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m n√†o"}),e.jsx("p",{className:"text-gray-600 mb-4",children:d?`Kh√¥ng c√≥ k·∫øt qu·∫£ cho "${d}". H√£y th·ª≠ t·ª´ kh√≥a kh√°c ho·∫∑c thay ƒë·ªïi b·ªô l·ªçc.`:"H√£y nh·∫≠p t·ª´ kh√≥a ƒë·ªÉ t√¨m ki·∫øm s·∫£n ph·∫©m."}),m()>0&&e.jsx(c,{onClick:S,variant:"outline",children:"X√≥a b·ªô l·ªçc"})]})})]})]})})]})};export{fe as default};
//# sourceMappingURL=ProductSearch-CVYFqj6q.js.map
