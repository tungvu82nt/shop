import{j as s}from"./ui-vendor-S1POobSh.js";import{j as D,u as S,r as l}from"./react-vendor-DrHQLvTy.js";import{P as f,B as N,c,i as d,j as m,d as h,K as r,U as k,a3 as q,q as v,a as T,$ as E,g as L}from"./index-B_z83aGI.js";import{A as y}from"./arrow-left-Bup_IKS6.js";import{M as b}from"./map-pin-Cx6R8BJE.js";import{C as M}from"./credit-card-DMGlkA9B.js";import"./chart-vendor-Bfyd95vO.js";import"./supabase-vendor-C-7U-qZP.js";import"./form-vendor-CeA2iSy3.js";const G=()=>{const{orderId:x}=D(),p=S(),[e,_]=l.useState(null),[w,o]=l.useState(!0),[j,g]=l.useState(null);l.useEffect(()=>{(async()=>{if(!x){g("Không tìm thấy mã đơn hàng"),o(!1);return}try{const{data:t,error:i}=await E.from("orders").select(`
            *,
            order_items (
              id,
              product_id,
              quantity,
              price,
              variant,
              products (
                name,
                images
              )
            )
          `).eq("id",x).single();if(i)throw i;if(!t){g("Không tìm thấy đơn hàng"),o(!1);return}const P={id:t.id,order_number:t.order_number,status:t.status,created_at:t.created_at,total_amount:t.total_amount,shipping_fee:t.shipping_fee||0,discount_amount:t.discount_amount||0,payment_method:t.payment_method,shipping_address:t.shipping_address,items:t.order_items.map(n=>({id:n.id,name:n.products.name,image:n.products.images[0]||"/placeholder-product.jpg",price:n.price,quantity:n.quantity,variant:n.variant}))};_(P)}catch(t){console.error("Error fetching order details:",t),g("Có lỗi xảy ra khi tải thông tin đơn hàng")}finally{o(!1)}})()},[x]);const u=a=>{const i={pending:{label:"Chờ xử lý",variant:"secondary"},confirmed:{label:"Đã xác nhận",variant:"default"},processing:{label:"Đang xử lý",variant:"default"},shipping:{label:"Đang giao hàng",variant:"default"},delivered:{label:"Đã giao hàng",variant:"default"},completed:{label:"Hoàn thành",variant:"default"},cancelled:{label:"Đã hủy",variant:"destructive"}}[a]||{label:a,variant:"secondary"};return s.jsx(L,{variant:i.variant,children:i.label})},C=a=>({cod:"Thanh toán khi nhận hàng",vnpay:"VNPay",momo:"MoMo",bank_transfer:"Chuyển khoản ngân hàng"})[a]||a;return w?s.jsx("div",{className:"max-w-4xl mx-auto p-6",children:s.jsxs("div",{className:"animate-pulse",children:[s.jsx("div",{className:"h-8 bg-gray-200 rounded mb-4"}),s.jsx("div",{className:"h-64 bg-gray-200 rounded mb-4"}),s.jsx("div",{className:"h-32 bg-gray-200 rounded"})]})}):j||!e?s.jsx("div",{className:"max-w-4xl mx-auto p-6",children:s.jsxs("div",{className:"text-center py-12",children:[s.jsx(f,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),s.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:j||"Không tìm thấy đơn hàng"}),s.jsxs(N,{onClick:()=>p("/orders"),variant:"outline",children:[s.jsx(y,{className:"h-4 w-4 mr-2"}),"Quay lại danh sách đơn hàng"]})]})}):s.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx(N,{variant:"ghost",size:"sm",onClick:()=>p(-1),className:"p-2",children:s.jsx(y,{className:"h-4 w-4"})}),s.jsxs("div",{children:[s.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:["Đơn hàng #",e.order_number]}),s.jsxs("p",{className:"text-sm text-gray-500",children:["Đặt hàng vào ",new Date(e.created_at).toLocaleDateString("vi-VN",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})]})]})]}),u(e.status)]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[s.jsxs(c,{children:[s.jsx(d,{children:s.jsxs(m,{className:"flex items-center",children:[s.jsx(f,{className:"h-5 w-5 mr-2"}),"Sản phẩm đã đặt"]})}),s.jsx(h,{children:s.jsx("div",{className:"space-y-4",children:e.items.map(a=>s.jsxs("div",{className:"flex items-center space-x-4 p-4 border rounded-lg",children:[s.jsx("img",{src:a.image,alt:a.name,className:"w-16 h-16 object-cover rounded-md"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-medium text-gray-900",children:a.name}),a.variant&&s.jsxs("p",{className:"text-sm text-gray-500",children:["Phân loại: ",a.variant]}),s.jsxs("p",{className:"text-sm text-gray-500",children:["Số lượng: ",a.quantity]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"font-medium text-gray-900",children:r(a.price*a.quantity)}),s.jsxs("p",{className:"text-sm text-gray-500",children:[r(a.price)," x ",a.quantity]})]})]},a.id))})})]}),s.jsxs(c,{children:[s.jsx(d,{children:s.jsxs(m,{className:"flex items-center",children:[s.jsx(b,{className:"h-5 w-5 mr-2"}),"Địa chỉ giao hàng"]})}),s.jsx(h,{children:s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(k,{className:"h-4 w-4 mr-2 text-gray-500"}),s.jsx("span",{className:"font-medium",children:e.shipping_address.name})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx(q,{className:"h-4 w-4 mr-2 text-gray-500"}),s.jsx("span",{children:e.shipping_address.phone})]}),s.jsxs("div",{className:"flex items-start",children:[s.jsx(b,{className:"h-4 w-4 mr-2 mt-0.5 text-gray-500"}),s.jsxs("div",{children:[s.jsx("p",{children:e.shipping_address.address}),s.jsxs("p",{className:"text-sm text-gray-500",children:[e.shipping_address.ward,", ",e.shipping_address.district,", ",e.shipping_address.province]})]})]})]})})]})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs(c,{children:[s.jsx(d,{children:s.jsxs(m,{className:"flex items-center",children:[s.jsx(M,{className:"h-5 w-5 mr-2"}),"Thông tin thanh toán"]})}),s.jsx(h,{children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Tạm tính:"}),s.jsx("span",{children:r(e.total_amount-e.shipping_fee+e.discount_amount)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Phí vận chuyển:"}),s.jsx("span",{children:r(e.shipping_fee)})]}),e.discount_amount>0&&s.jsxs("div",{className:"flex justify-between text-green-600",children:[s.jsx("span",{children:"Giảm giá:"}),s.jsxs("span",{children:["-",r(e.discount_amount)]})]}),s.jsx(v,{}),s.jsxs("div",{className:"flex justify-between font-semibold text-lg",children:[s.jsx("span",{children:"Tổng cộng:"}),s.jsx("span",{className:"text-red-600",children:r(e.total_amount)})]}),s.jsx(v,{}),s.jsxs("div",{className:"pt-2",children:[s.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Phương thức thanh toán:"}),s.jsx("p",{className:"font-medium",children:C(e.payment_method)})]})]})})]}),s.jsxs(c,{children:[s.jsx(d,{children:s.jsxs(m,{className:"flex items-center",children:[s.jsx(T,{className:"h-5 w-5 mr-2"}),"Trạng thái đơn hàng"]})}),s.jsx(h,{children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{children:"Trạng thái hiện tại:"}),u(e.status)]}),s.jsx("div",{className:"text-sm text-gray-600",children:s.jsxs("p",{children:["Cập nhật lần cuối: ",new Date(e.created_at).toLocaleDateString("vi-VN")]})})]})})]})]})]})]})};export{G as default};
//# sourceMappingURL=OrderDetailPage-kPiW94sv.js.map
