import{j as e}from"./ui-vendor-S1POobSh.js";import{u as $,r as d,L as u}from"./react-vendor-DrHQLvTy.js";import{n as I,i as L,j as Y,k as A,d as U,l as i,U as B,I as m,M as O,a3 as H,ao as _,a8 as k,a7 as S,B as R,m as f,b as j}from"./index-B_z83aGI.js";import{C}from"./checkbox-B751KjRM.js";import{S as G,a as K,b as X,c as q,d as y}from"./select-gZt-o9w_.js";import{P as z}from"./progress-lxZ0-YvS.js";import{A as J}from"./AuthLayout-DxpTxSLH.js";import{s as N,a as Q}from"./authService-guulQlN8.js";import"./chart-vendor-Bfyd95vO.js";import"./supabase-vendor-C-7U-qZP.js";import"./form-vendor-CeA2iSy3.js";import"./chevron-down-B_2yl-Ju.js";import"./chevron-up-DCfO1O8C.js";import"./shield-CnI5vR7_.js";import"./users-B4TySy3P.js";import"./arrow-left-Bup_IKS6.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=I("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),pe=()=>{const P=$(),[s,h]=d.useState({email:"",password:"",confirmPassword:"",full_name:"",phone:"",date_of_birth:"",gender:"",agree_terms:!1,agree_marketing:!1}),[r,x]=d.useState({}),[g,V]=d.useState(!1),[p,F]=d.useState(!1),[l,b]=d.useState(!1),[o,v]=d.useState({score:0,feedback:[],isStrong:!1});d.useEffect(()=>{Object.keys(r).length>0&&x({})},[s]),d.useEffect(()=>{if(s.password){const a=N.checkPasswordStrength(s.password);v(a)}else v({score:0,feedback:[],isStrong:!1})},[s.password]);const E=()=>{const a={};if(s.full_name.trim()?s.full_name.trim().length<2&&(a.full_name="Họ và tên phải có ít nhất 2 ký tự"):a.full_name="Vui lòng nhập họ và tên",!s.email.trim())a.email="Vui lòng nhập email";else{const t=N.validateEmail(s.email);t.isValid||(a.email=t.errors[0])}if(s.phone.trim()?/^(\+84|0)[3-9]\d{8}$/.test(s.phone.replace(/\s/g,""))||(a.phone="Số điện thoại không hợp lệ"):a.phone="Vui lòng nhập số điện thoại",!s.password)a.password="Vui lòng nhập mật khẩu";else{const t=N.validatePassword(s.password);t.isValid||(a.password=t.errors[0])}if(s.confirmPassword?s.password!==s.confirmPassword&&(a.confirmPassword="Mật khẩu xác nhận không khớp"):a.confirmPassword="Vui lòng xác nhận mật khẩu",!s.date_of_birth)a.date_of_birth="Vui lòng chọn ngày sinh";else{const t=new Date(s.date_of_birth);new Date().getFullYear()-t.getFullYear()<13&&(a.date_of_birth="Bạn phải từ 13 tuổi trở lên")}return s.agree_terms||(a.agree_terms="Bạn phải đồng ý với điều khoản sử dụng"),x(a),Object.keys(a).length===0},T=async a=>{if(a.preventDefault(),!!E()){b(!0);try{const t={email:s.email.trim().toLowerCase(),password:s.password,full_name:s.full_name.trim(),phone:s.phone.replace(/\s/g,""),date_of_birth:s.date_of_birth,gender:s.gender||void 0},n=await Q.signUp(t);if(n.error){x({general:n.error}),f.error(n.error),j.trackAuth("sign_up_failed",{method:"email",error:n.error});return}n.user&&(f.success("Đăng ký thành công! Vui lòng kiểm tra email để xác thực tài khoản."),j.trackAuth("sign_up",{method:"email",user_id:n.user.id}),P("/login",{state:{message:"Đăng ký thành công! Vui lòng kiểm tra email để xác thực tài khoản.",email:s.email}}))}catch(t){console.error("Register error:",t),f.error("Đã xảy ra lỗi. Vui lòng thử lại."),j.trackAuth("sign_up_failed",{method:"email",error:t instanceof Error?t.message:"Unknown error"}),x({general:"Đã xảy ra lỗi hệ thống"})}finally{b(!1)}}},c=a=>t=>{const n=["agree_terms","agree_marketing"].includes(a)?t.target.checked:t.target.value;h(w=>({...w,[a]:n}))},D=a=>t=>{h(n=>({...n,[a]:t}))},M=()=>o.score<=2?"Yếu":o.score<=4?"Trung bình":"Mạnh";return e.jsxs(J,{title:"Tham gia Yapee ngay hôm nay!",subtitle:"Tạo tài khoản để khám phá hàng triệu sản phẩm với giá tốt nhất",children:[e.jsxs(L,{className:"text-center pb-6",children:[e.jsx(Y,{className:"text-2xl font-bold text-gray-800",children:"Đăng ký"}),e.jsx(A,{className:"text-gray-600",children:"Tạo tài khoản Yapee để bắt đầu mua sắm!"})]}),e.jsxs(U,{className:"space-y-6",children:[r.general&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:e.jsx("p",{className:"text-red-600 text-sm",children:r.general})}),e.jsxs("form",{onSubmit:T,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"full_name",className:"text-gray-700 font-medium",children:"Họ và tên *"}),e.jsxs("div",{className:"relative",children:[e.jsx(B,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(m,{id:"full_name",type:"text",placeholder:"Nhập họ và tên đầy đủ",value:s.full_name,onChange:c("full_name"),className:`pl-10 h-12 ${r.full_name?"border-red-300 focus:border-red-500":""}`,disabled:l})]}),r.full_name&&e.jsx("p",{className:"text-red-500 text-sm",children:r.full_name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"email",className:"text-gray-700 font-medium",children:"Email *"}),e.jsxs("div",{className:"relative",children:[e.jsx(O,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(m,{id:"email",type:"email",placeholder:"Nhập email của bạn",value:s.email,onChange:c("email"),className:`pl-10 h-12 ${r.email?"border-red-300 focus:border-red-500":""}`,disabled:l})]}),r.email&&e.jsx("p",{className:"text-red-500 text-sm",children:r.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"phone",className:"text-gray-700 font-medium",children:"Số điện thoại *"}),e.jsxs("div",{className:"relative",children:[e.jsx(H,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(m,{id:"phone",type:"tel",placeholder:"Nhập số điện thoại",value:s.phone,onChange:c("phone"),className:`pl-10 h-12 ${r.phone?"border-red-300 focus:border-red-500":""}`,disabled:l})]}),r.phone&&e.jsx("p",{className:"text-red-500 text-sm",children:r.phone})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"date_of_birth",className:"text-gray-700 font-medium",children:"Ngày sinh *"}),e.jsxs("div",{className:"relative",children:[e.jsx(W,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(m,{id:"date_of_birth",type:"date",value:s.date_of_birth,onChange:c("date_of_birth"),className:`pl-10 h-12 ${r.date_of_birth?"border-red-300 focus:border-red-500":""}`,disabled:l,max:new Date().toISOString().split("T")[0]})]}),r.date_of_birth&&e.jsx("p",{className:"text-red-500 text-sm",children:r.date_of_birth})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{className:"text-gray-700 font-medium",children:"Giới tính"}),e.jsxs(G,{value:s.gender,onValueChange:D("gender"),disabled:l,children:[e.jsx(K,{className:"h-12",children:e.jsx(X,{placeholder:"Chọn giới tính"})}),e.jsxs(q,{children:[e.jsx(y,{value:"male",children:"Nam"}),e.jsx(y,{value:"female",children:"Nữ"}),e.jsx(y,{value:"other",children:"Khác"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"password",className:"text-gray-700 font-medium",children:"Mật khẩu *"}),e.jsxs("div",{className:"relative",children:[e.jsx(_,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(m,{id:"password",type:g?"text":"password",placeholder:"Nhập mật khẩu",value:s.password,onChange:c("password"),className:`pl-10 pr-10 h-12 ${r.password?"border-red-300 focus:border-red-500":""}`,disabled:l}),e.jsx("button",{type:"button",onClick:()=>V(!g),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",disabled:l,children:g?e.jsx(k,{className:"w-4 h-4"}):e.jsx(S,{className:"w-4 h-4"})})]}),s.password&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Độ mạnh mật khẩu:"}),e.jsx("span",{className:`text-sm font-medium ${o.score<=2?"text-red-500":o.score<=4?"text-yellow-500":"text-green-500"}`,children:M()})]}),e.jsx(z,{value:o.score/6*100,className:"h-2"}),o.feedback.length>0&&e.jsx("ul",{className:"text-xs text-gray-600 space-y-1",children:o.feedback.map((a,t)=>e.jsxs("li",{children:["• ",a]},t))})]}),r.password&&e.jsx("p",{className:"text-red-500 text-sm",children:r.password})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"confirmPassword",className:"text-gray-700 font-medium",children:"Xác nhận mật khẩu *"}),e.jsxs("div",{className:"relative",children:[e.jsx(_,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(m,{id:"confirmPassword",type:p?"text":"password",placeholder:"Nhập lại mật khẩu",value:s.confirmPassword,onChange:c("confirmPassword"),className:`pl-10 pr-10 h-12 ${r.confirmPassword?"border-red-300 focus:border-red-500":""}`,disabled:l}),e.jsx("button",{type:"button",onClick:()=>F(!p),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",disabled:l,children:p?e.jsx(k,{className:"w-4 h-4"}):e.jsx(S,{className:"w-4 h-4"})})]}),r.confirmPassword&&e.jsx("p",{className:"text-red-500 text-sm",children:r.confirmPassword})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(C,{id:"agree_terms",checked:s.agree_terms,onCheckedChange:a=>h(t=>({...t,agree_terms:a})),disabled:l,className:"mt-1"}),e.jsxs(i,{htmlFor:"agree_terms",className:"text-sm text-gray-600 leading-relaxed",children:["Tôi đồng ý với"," ",e.jsx(u,{to:"/terms",className:"text-orange-600 hover:underline",children:"Điều khoản dịch vụ"})," ","và"," ",e.jsx(u,{to:"/privacy",className:"text-orange-600 hover:underline",children:"Chính sách bảo mật"})," ","của Yapee *"]})]}),r.agree_terms&&e.jsx("p",{className:"text-red-500 text-sm",children:r.agree_terms}),e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(C,{id:"agree_marketing",checked:s.agree_marketing,onCheckedChange:a=>h(t=>({...t,agree_marketing:a})),disabled:l,className:"mt-1"}),e.jsx(i,{htmlFor:"agree_marketing",className:"text-sm text-gray-600 leading-relaxed",children:"Tôi muốn nhận thông tin khuyến mãi và ưu đãi từ Yapee"})]})]}),e.jsx(R,{type:"submit",className:"w-full h-12 bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white font-semibold",disabled:l||!o.isStrong,children:l?"Đang tạo tài khoản...":"Đăng ký"})]}),e.jsx("div",{className:"text-center pt-4",children:e.jsxs("p",{className:"text-gray-600",children:["Đã có tài khoản?"," ",e.jsx(u,{to:"/login",className:"text-orange-600 hover:text-orange-700 font-semibold",children:"Đăng nhập ngay"})]})})]})]})};export{pe as default};
//# sourceMappingURL=RegisterPage-Bn06fsBb.js.map
