import{j as e}from"./ui-vendor-S1POobSh.js";import{k,u as v,r as n,L as x}from"./react-vendor-DrHQLvTy.js";import{u as E,m as a,c as S,i as V,j as A,k as X,d as B,B as t,a5 as o,M as d,O as F,Q as R}from"./index-B_z83aGI.js";import{a as N}from"./authService-guulQlN8.js";import{A as L}from"./AuthLayout-DxpTxSLH.js";import{C as M}from"./circle-x-CvsfpNQ6.js";import{C as P}from"./circle-check-big-DJfGvp7v.js";import"./chart-vendor-Bfyd95vO.js";import"./supabase-vendor-C-7U-qZP.js";import"./form-vendor-CeA2iSy3.js";import"./shield-CnI5vR7_.js";import"./users-B4TySy3P.js";import"./arrow-left-Bup_IKS6.js";function Y(){const[u]=k(),y=v(),{user:i}=E(),[b,l]=n.useState("pending"),[c,g]=n.useState(!1),[j,m]=n.useState(""),r=u.get("token"),p=u.get("email");n.useEffect(()=>{r&&C(r)},[r]);const C=async s=>{try{const{error:h}=await N.verifyEmail(s);h?(l("error"),m(h)):(l("success"),m("Email đã được xác thực thành công!"),a.success("Email đã được xác thực thành công!"),setTimeout(()=>{y("/login")},3e3))}catch{l("error"),m("Có lỗi xảy ra khi xác thực email")}},f=async()=>{if(!p&&!(i!=null&&i.email)){a.error("Không tìm thấy email để gửi lại xác thực");return}g(!0);try{const{error:s}=await N.sendVerificationEmail(p||i.email);s?a.error(s):a.success("Email xác thực đã được gửi lại!")}catch{a.error("Có lỗi xảy ra khi gửi email xác thực")}finally{g(!1)}},w=()=>{if(r)switch(b){case"pending":return e.jsxs("div",{className:"text-center",children:[e.jsx(o,{className:"h-12 w-12 mx-auto mb-4 animate-spin text-blue-500"}),e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Đang xác thực email..."}),e.jsx("p",{className:"text-gray-600",children:"Vui lòng đợi trong giây lát"})]});case"success":return e.jsxs("div",{className:"text-center",children:[e.jsx(P,{className:"h-12 w-12 mx-auto mb-4 text-green-500"}),e.jsx("h2",{className:"text-xl font-semibold mb-2 text-green-700",children:"Xác thực thành công!"}),e.jsx("p",{className:"text-gray-600 mb-4",children:j}),e.jsx("p",{className:"text-sm text-gray-500",children:"Bạn sẽ được chuyển hướng đến trang đăng nhập..."}),e.jsx(t,{asChild:!0,className:"mt-4",children:e.jsx(x,{to:"/login",children:"Đăng nhập ngay"})})]});case"error":return e.jsxs("div",{className:"text-center",children:[e.jsx(M,{className:"h-12 w-12 mx-auto mb-4 text-red-500"}),e.jsx("h2",{className:"text-xl font-semibold mb-2 text-red-700",children:"Xác thực thất bại"}),e.jsx("p",{className:"text-gray-600 mb-4",children:j}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{onClick:f,disabled:c,className:"w-full",children:c?e.jsxs(e.Fragment,{children:[e.jsx(o,{className:"h-4 w-4 mr-2 animate-spin"}),"Đang gửi..."]}):e.jsxs(e.Fragment,{children:[e.jsx(d,{className:"h-4 w-4 mr-2"}),"Gửi lại email xác thực"]})}),e.jsx(t,{variant:"outline",asChild:!0,className:"w-full",children:e.jsx(x,{to:"/login",children:"Quay lại đăng nhập"})})]})]})}else return e.jsxs("div",{className:"text-center",children:[e.jsx(d,{className:"h-12 w-12 mx-auto mb-4 text-blue-500"}),e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Xác thực email của bạn"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Chúng tôi đã gửi một email xác thực đến địa chỉ email của bạn. Vui lòng kiểm tra hộp thư và nhấp vào liên kết xác thực."}),e.jsx(F,{className:"mb-4",children:e.jsx(R,{children:"Nếu bạn không thấy email, hãy kiểm tra thư mục spam hoặc thư rác."})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{onClick:f,disabled:c,className:"w-full",children:c?e.jsxs(e.Fragment,{children:[e.jsx(o,{className:"h-4 w-4 mr-2 animate-spin"}),"Đang gửi..."]}):e.jsxs(e.Fragment,{children:[e.jsx(d,{className:"h-4 w-4 mr-2"}),"Gửi lại email xác thực"]})}),e.jsx(t,{variant:"outline",asChild:!0,className:"w-full",children:e.jsx(x,{to:"/login",children:"Quay lại đăng nhập"})})]})]})};return e.jsx(L,{children:e.jsxs(S,{className:"w-full max-w-md mx-auto",children:[e.jsxs(V,{children:[e.jsx(A,{className:"text-center",children:"Xác thực Email"}),e.jsx(X,{className:"text-center",children:"Hoàn tất quá trình đăng ký tài khoản"})]}),e.jsx(B,{children:w()})]})})}export{Y as default};
//# sourceMappingURL=EmailVerificationPage-BR4swlOf.js.map
