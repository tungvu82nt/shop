{"version":3,"file":"Cart-B9wzJ2Ra.js","sources":["../../src/pages/Cart.tsx"],"sourcesContent":["import React, { useEffect } from 'react'\nimport { useNavigate } from 'react-router-dom'\nimport { ShoppingCart, ArrowLeft } from 'lucide-react'\nimport { Button } from '@/components/ui/button'\nimport { useCart } from '@/contexts/CartContext'\nimport { formatPrice } from '@/lib/utils'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Badge } from '@/components/ui/badge'\nimport { Separator } from '@/components/ui/separator'\nimport { analytics } from '@/lib/analytics'\n\n/**\n * Trang Cart - Hiển thị giỏ hàng dưới dạng trang riêng\n * Cho phép người dùng xem và quản lý giỏ hàng\n */\nconst Cart: React.FC = () => {\n  const navigate = useNavigate()\n  const { state, removeItem, updateQuantity, clearCart, getItemKey } = useCart()\n  const { items, totalItems, totalPrice } = state\n\n  // Track view cart analytics when component mounts\n  useEffect(() => {\n    analytics.trackEcommerce('view_cart', {\n      currency: 'VND',\n      value: totalPrice,\n      items: items.map(item => ({\n        item_id: item.product.id.toString(),\n        item_name: item.product.name,\n        item_category: item.product.category,\n        item_brand: item.product.brand,\n        price: item.product.price,\n        quantity: item.quantity\n      }))\n    });\n  }, [items, totalPrice]);\n\n  /**\n   * Xử lý tăng số lượng sản phẩm\n   */\n  const handleIncreaseQuantity = (itemKey: string, currentQuantity: number, maxQuantity: number) => {\n    if (currentQuantity < maxQuantity) {\n      const item = items.find(item => getItemKey(item.product.id, item.selectedVariant) === itemKey)\n      if (item) {\n        // Track quantity increase analytics\n        analytics.track('cart_item_quantity_increased', {\n          item_id: item.product.id.toString(),\n          item_name: item.product.name,\n          old_quantity: currentQuantity,\n          new_quantity: currentQuantity + 1,\n          price: item.product.price\n        });\n      }\n      updateQuantity(itemKey, currentQuantity + 1)\n    }\n  }\n\n  /**\n   * Xử lý giảm số lượng sản phẩm\n   */\n  const handleDecreaseQuantity = (itemKey: string, currentQuantity: number) => {\n    if (currentQuantity > 1) {\n      const item = items.find(item => getItemKey(item.product.id, item.selectedVariant) === itemKey)\n      if (item) {\n        // Track quantity decrease analytics\n        analytics.track('cart_item_quantity_decreased', {\n          item_id: item.product.id.toString(),\n          item_name: item.product.name,\n          old_quantity: currentQuantity,\n          new_quantity: currentQuantity - 1,\n          price: item.product.price\n        });\n      }\n      updateQuantity(itemKey, currentQuantity - 1)\n    }\n  }\n\n  /**\n   * Xử lý xóa sản phẩm khỏi giỏ hàng\n   */\n  const handleRemoveItem = (itemKey: string) => {\n    const item = items.find(item => getItemKey(item.product.id, item.selectedVariant) === itemKey)\n    if (item) {\n      // Track remove from cart analytics\n      analytics.trackEcommerce('remove_from_cart', {\n        currency: 'VND',\n        value: item.product.price * item.quantity,\n        items: [{\n          item_id: item.product.id.toString(),\n          item_name: item.product.name,\n          item_category: item.product.category,\n          item_brand: item.product.brand,\n          price: item.product.price,\n          quantity: item.quantity\n        }]\n      });\n    }\n    removeItem(itemKey)\n  }\n\n  /**\n   * Xử lý thanh toán\n   */\n  const handleCheckout = () => {\n    // Track begin checkout analytics\n    analytics.trackEcommerce('begin_checkout', {\n      currency: 'VND',\n      value: totalPrice,\n      items: items.map(item => ({\n        item_id: item.product.id.toString(),\n        item_name: item.product.name,\n        item_category: item.product.category,\n        item_brand: item.product.brand,\n        price: item.product.price,\n        quantity: item.quantity\n      }))\n    });\n    \n    navigate('/checkout')\n  }\n\n  /**\n   * Xử lý quay lại trang trước\n   */\n  const handleGoBack = () => {\n    navigate(-1)\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      {/* Header */}\n      <div className=\"bg-white shadow-sm border-b\">\n        <div className=\"container mx-auto px-4 py-4\">\n          <div className=\"flex items-center gap-4\">\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              onClick={handleGoBack}\n              className=\"flex items-center gap-2\"\n            >\n              <ArrowLeft className=\"h-4 w-4\" />\n              Quay lại\n            </Button>\n            <div className=\"flex items-center gap-2\">\n              <ShoppingCart className=\"h-6 w-6\" />\n              <h1 className=\"text-2xl font-bold\">Giỏ hàng</h1>\n              {totalItems > 0 && (\n                <Badge variant=\"secondary\">\n                  {totalItems} sản phẩm\n                </Badge>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"container mx-auto px-4 py-8\">\n        {items.length === 0 ? (\n          // Giỏ hàng trống\n          <Card className=\"text-center py-12\">\n            <CardContent>\n              <ShoppingCart className=\"h-16 w-16 mx-auto text-gray-400 mb-4\" />\n              <h2 className=\"text-xl font-semibold mb-2\">Giỏ hàng trống</h2>\n              <p className=\"text-gray-600 mb-6\">Hãy thêm sản phẩm vào giỏ hàng để tiếp tục mua sắm</p>\n              <Button onClick={() => navigate('/')} className=\"bg-orange-500 hover:bg-orange-600\">\n                Tiếp tục mua sắm\n              </Button>\n            </CardContent>\n          </Card>\n        ) : (\n          // Có sản phẩm trong giỏ hàng\n          <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n            {/* Danh sách sản phẩm */}\n            <div className=\"lg:col-span-2 space-y-4\">\n              <Card>\n                <CardHeader>\n                  <CardTitle>Sản phẩm trong giỏ hàng</CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  {items.map((item) => {\n                    const itemKey = getItemKey(item.product.id, item.selectedVariant)\n                    return (\n                      <div key={itemKey} className=\"flex gap-4 p-4 border rounded-lg\">\n                        {/* Hình ảnh sản phẩm */}\n                        <div className=\"w-20 h-20 bg-gray-200 rounded-lg flex-shrink-0 overflow-hidden\">\n                          <img\n                            src={item.product.images?.[0] || '/placeholder.svg'}\n                            alt={item.product.name}\n                            className=\"w-full h-full object-cover\"\n                          />\n                        </div>\n\n                        {/* Thông tin sản phẩm */}\n                        <div className=\"flex-1\">\n                          <h3 className=\"font-medium text-sm mb-1\">{item.product.name}</h3>\n                          {item.selectedVariant && (\n                            <p className=\"text-xs text-gray-600 mb-2\">\n                              Phân loại: {item.selectedVariant.color} - {item.selectedVariant.size}\n                            </p>\n                          )}\n                          <div className=\"flex items-center justify-between\">\n                            <div className=\"flex items-center gap-2\">\n                              <Button\n                                variant=\"outline\"\n                                size=\"sm\"\n                                onClick={() => handleDecreaseQuantity(itemKey, item.quantity)}\n                                disabled={item.quantity <= 1}\n                                className=\"h-8 w-8 p-0\"\n                              >\n                                -\n                              </Button>\n                              <span className=\"w-8 text-center text-sm\">{item.quantity}</span>\n                              <Button\n                                variant=\"outline\"\n                                size=\"sm\"\n                                onClick={() => handleIncreaseQuantity(itemKey, item.quantity, item.selectedVariant?.stock || item.product.stock)}\n                                disabled={item.quantity >= (item.selectedVariant?.stock || item.product.stock)}\n                                className=\"h-8 w-8 p-0\"\n                              >\n                                +\n                              </Button>\n                            </div>\n                            <div className=\"text-right\">\n                              <p className=\"font-semibold text-orange-600\">\n                                {formatPrice(item.product.price * item.quantity)}\n                              </p>\n                              <Button\n                                variant=\"ghost\"\n                                size=\"sm\"\n                                onClick={() => handleRemoveItem(itemKey)}\n                                className=\"text-red-500 hover:text-red-700 p-0 h-auto\"\n                              >\n                                Xóa\n                              </Button>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                    )\n                  })}\n                </CardContent>\n              </Card>\n            </div>\n\n            {/* Tóm tắt đơn hàng */}\n            <div className=\"space-y-4\">\n              <Card>\n                <CardHeader>\n                  <CardTitle>Tóm tắt đơn hàng</CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div className=\"flex justify-between\">\n                    <span>Tạm tính ({totalItems} sản phẩm)</span>\n                    <span>{formatPrice(totalPrice)}</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span>Phí vận chuyển</span>\n                    <span className=\"text-green-600\">Miễn phí</span>\n                  </div>\n                  <Separator />\n                  <div className=\"flex justify-between font-semibold text-lg\">\n                    <span>Tổng cộng</span>\n                    <span className=\"text-orange-600\">{formatPrice(totalPrice)}</span>\n                  </div>\n                  <Button\n                    onClick={handleCheckout}\n                    className=\"w-full bg-orange-500 hover:bg-orange-600\"\n                    size=\"lg\"\n                  >\n                    Thanh toán\n                  </Button>\n                  <Button\n                    variant=\"outline\"\n                    onClick={() => navigate('/')}\n                    className=\"w-full\"\n                  >\n                    Tiếp tục mua sắm\n                  </Button>\n                </CardContent>\n              </Card>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  )\n}\n\nexport default Cart"],"names":["Cart","navigate","useNavigate","state","removeItem","updateQuantity","clearCart","getItemKey","useCart","items","totalItems","totalPrice","useEffect","analytics","item","handleIncreaseQuantity","itemKey","currentQuantity","maxQuantity","handleDecreaseQuantity","handleRemoveItem","handleCheckout","handleGoBack","jsxs","jsx","Button","ArrowLeft","ShoppingCart","Badge","Card","CardContent","CardHeader","CardTitle","_a","_b","formatPrice","Separator"],"mappings":"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"}